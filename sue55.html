<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Donation Page with Validation and Data Retrieval</title>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- অন্যান্য স্ক্রিপ্ট এবং CSS লিঙ্কগুলি এখানে যুক্ত করুন -->
</head>
<body>
<div style="display: flex; flex-wrap: wrap; min-height: 50%; background-image: linear-gradient(0deg, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('/Donation-3.jpg'); background-position: center center; background-repeat: no-repeat; background-size: cover;" class="row sectionBlockLayout" data-component-theme="portalThemeColor8">
<div class="container">
<div style="flex-grow: 1; display: flex; flex-direction: column; margin: 240px 0px;" class="col-md-12 columnBlockLayout">
<h1 style="text-align: center;">Support Our Cause</h1>
<h4 style="text-align: center;">Make a Donation Today</h4>
<button style="text-align: center; margin-left: auto; margin-right: auto;" class="button1">Donate Now</button>
</div>
</div>
</div>

<div style="display: flex; flex-wrap: wrap; margin: 0px; min-height: auto; padding: 8px;" class="row sectionBlockLayout text-left" data-component-theme="portalThemeColor">
<div style="padding: 0px; display: flex; flex-wrap: wrap;" class="container">
<div style="word-break: break-word; flex-grow: 1; display: flex; flex-direction: column; min-width: 300px;" class="col-md-12 columnBlockLayout">
<h2 style="text-align: center;">Why Donate?</h2>
<p style="text-align: center;">Your generous donation will help us continue our mission to make a positive impact in the community. With your support, we can create a better future for those in need.</p>
</div>
</div>
</div>

<div style="display: flex; flex-wrap: wrap; margin: 0px; min-height: 451.25px; padding: 8px;" class="row sectionBlockLayout text-left" data-component-theme="portalThemeColor">
<div style="padding: 0px; display: flex; flex-wrap: wrap; column-gap: 0px;" class="container">
<div style="word-break: break-word; flex-grow: 1; display: flex; flex-direction: column; min-width: 300px; margin: 60px 0px; padding: 16px; width: calc(50% - 0px);" class="col-md-6 columnBlockLayout"><img style="width: 100%; height: auto; max-width: 100%;" name="Donation" alt="Image showing people donating" src="/Donation.jpg"></div>
<div style="word-break: break-word; flex-grow: 1; display: flex; flex-direction: column; min-width: 300px; margin: 60px 0px; padding: 16px; width: calc(50% - 0px);" class="col-md-6 columnBlockLayout">
<h2>How to Donate</h2>
<p>Donating is quick and easy. Simply click the button below to make a secure online donation. Your contribution will go directly towards supporting our programs and initiatives.</p>
<button class="button1" value="/" type="button">Donate Now</button>
</div>
</div>
</div>

<div style="display: flex; flex-wrap: wrap; margin: 0px; min-height: auto; padding: 8px;" class="row sectionBlockLayout text-left" data-component-theme="portalThemeColor">
<div style="padding: 0px; display: flex; flex-wrap: wrap;" class="container">
<div style="word-break: break-word; flex-grow: 1; display: flex; flex-direction: column; min-width: 300px;" class="col-md-6 columnBlockLayout">
<h2>Our Impact</h2>
<p>With the support of generous donors like you, we have been able to make a significant impact in the lives of individuals and communities. Together, we can create positive change and build a brighter future.</p>
</div>
<div style="word-break: break-word; flex-grow: 1; display: flex; flex-direction: column; min-width: 300px;" class="col-md-6 columnBlockLayout"><img src="/Donation-2.jpg" alt="Image showing impact" style="width: 100%; height: auto; border-radius: 8px;"></div>
</div>
</div>
<script>
// আপনার প্রদান করা জাভাস্ক্রিপ্ট কোডগুলি এখানে যুক্ত করুন
if (window.jQuery) {
   (function ($)
 {
      $(document).ready(function () {
         if (typeof (Page_Validators) == 'undefined') return;
         // Create new validator
         var newValidator = document.createElement('span');
         newValidator.style.display = "none";
         newValidator.id = "phoneValidator";
         newValidator.controltovalidate = "phone";
         newValidator.errormessage = "Phone number is not in valid format.";
         newValidator.validationGroup = ""; // Set this if you have set ValidationGroup on the form
         newValidator.initialvalue = "";
         newValidator.evaluationfunction = function () {
            // check if phone number is in valid format
            var value = $("#phone").val();
            var phonePattern = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;
            if (value == null || value == "" || !phonePattern.test(value)) {
            return false;
            } else {
               return true;
            }
         };
// আপনার প্রথম কোড ব্লক
}

if (window.jQuery) {
   (function ($)
 {
      $(document).ready(function () {
         if (typeof (Page_Validators) == 'undefined') return;
         // Create new validator
         var newValidator = document.createElement('span');
         newValidator.style.display = "none";
         newValidator.id = "phoneValidator";
         newValidator.controltovalidate = "phone";
         newValidator.errormessage = "Phone number is not in valid format.";
         newValidator.validationGroup = ""; // Set this if you have set ValidationGroup on the form
         newValidator.initialvalue = "";
         newValidator.evaluationfunction = function () {
            // check if phone number is in valid format
            var value = $("#phone").val();
            var phonePattern = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;
            if (value == null || value == "" || !phonePattern.test(value)) {
            return false;
            } else {
               return true;
            }
         };

         // Add the new validator to the page validators array:
         Page_Validators.push(newValidator);

      });
   }(window.jQuery));
}

$(() => {
    let htmlElement = '#table-container';
    $(htmlElement).html('Loading...');
    webapi.safeAjax({
        type: "GET",
        url: "/_api/contacts?$filter=statuscode eq 1",
        contentType: "application/json",
        success: (res) => ($(htmlElement).html(generateHTMLTable(res.value)))
    }).fail(res => errorHandler(res))
});

unction generateHTMLTable(data) {
    let table = '<table style="width: 100%; border-collapse: collapse;">';
    const excludedKey = '@odata.etag';
    // Generate table headers
    table += `<thead><tr>${Object.keys(data[0])
        .filter(key => key !== excludedKey)
        .map(key => `<th style="padding: 8px; border: 1px solid #ccc; background-color: #f2f2f2; color: #333;">${key}</th>`)
        .join('')}</tr></thead>`;
    // Generate table rows
    table += '<tbody>';
    for (let i = 0; i < data.length; i++) {
        table += '<tr>';
        table += Object.entries(data[i])
            .filter(([key]) => key !== excludedKey)
            .map(([key, value]) => `<td style="padding: 8px; border: 1px solid #ccc;">${value || ''}</td>`)
            .join('');
        table += '</tr>';
    }
    table += '</tbody>';
    table += '</table>';
    return table;
}


function errorHandler(response) {
    if (response.responseJSON) {
        var error = response.responseJSON.error.code;
        switch (error) {
            case "9004010C":
                alert("Error: Site settings missing for entity.");
                break;
            case "90040101":
                alert("Error: Site settings missing for entity fields.");
                break;
            case "90040120":
                alert("Error: Table permissions missing for entity.");
                break;
            default:
                alert("Error: " + response.responseJSON.error.message);
        }
    } else {
        alert("Error: Web API is not available... ");
    }
}

((webapi, $) => {
    webapi.safeAjax = (opts) => {
        const deferredAjax = $.Deferred();
        shell.getTokenDeferred().done(token => $.ajax({ ...opts, headers: { ...opts.headers, '__RequestVerificationToken': token } })
            .done((data, textStatus, jqXHR) => validateLoginSession(data, textStatus, jqXHR, deferredAjax.resolve))
            .fail(deferredAjax.reject)).fail(() => deferredAjax.rejectWith(this, arguments));
        return deferredAjax.promise();
    };
})(window.webapi = window.webapi || {}, jQuery);
</script>

</body>
</html>


